@using MyGame.Models

@model GameModel

@{
    ViewBag.Title = "SIngleTable";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Addons
{
    <link href="~/Content/Checkers.css" />
    <script src="~/Scripts/FillTableFithFigures.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.signalR-2.3.0.min.js"></script>
    <script src="~/Scripts/Bibles/jquery-ui-1.12.1.min.js"></script>
    <script src="/signalr/hubs"></script>
    <script src="~/Scripts/makeMove.js" type="text/javascript"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            var color = "White";
            @if (Model.ThisPlayerId == Model.BlackId)
            {
                <text>
                    color = "Black"
                </text>

                for (int i = 0; i < Model.Figures.Count(); i++)
                {
                    Model.Figures.ElementAt(i).XCoord = 11 - Model.Figures.ElementAt(i).XCoord;
                    Model.Figures.ElementAt(i).YCoord = 11 - Model.Figures.ElementAt(i).YCoord;
                }
            };
            var FiguresModel = @Html.Raw(Json.Encode(Model.Figures));
            var GameModel = @Html.Raw(Json.Encode(Model));
            FillTable(FiguresModel);
            SetupMove(GameModel, color);
        });
    </script>

}

<div id="checkersTable">
    @for (int i = 1; i <= 10; i++)
    {
        string color = "#C9956E";
        if ((i % 2) == 0)
        {
            color = "#3B363A";
        }
        <div id="row_@i">
            @for (int j = 1; j <= 10; j++)
            {
                var field = new MyGame.Models.FieldModel
                {
                    X = j,
                    Y = i,
                    Color = color
                };

                Html.RenderPartial("square", field);
                if (color == "#3B363A")
                {
                    color = "#C9956E";
                }
                else
                {
                    color = "#3B363A";
                }
            }
        </div>
    }
</div>

